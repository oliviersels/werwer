// Generated by CoffeeScript 1.4.0
(function() {
  var werServices;

  werServices = angular.module('werServices', ['ngResource']);

  werServices.factory('werApi', [
    '$q', '$http', '$resource', function($q, $http, $resource) {
      var createResource, createService;
      createService = function(serviceName, serviceUrl) {
        return $resource(serviceUrl + ':id/', {
          id: "@id"
        }, {
          update: {
            method: 'PUT'
          }
        });
      };
      createResource = function(resourceName) {
        var deferred;
        deferred = $q.defer();
        $http({
          method: 'GET',
          url: '/api/',
          cache: true
        }).success(function(data) {
          return deferred.resolve(createService(resourceName, data[resourceName]));
        }).error(function(data) {
          return deferred.reject("Error retrieving API endpoint: " + data);
        });
        return deferred.promise;
      };
      return {
        Player: createResource('players'),
        Game: createResource('games'),
        Match: createResource('matches')
      };
    }
  ]);

}).call(this);
